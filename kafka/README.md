# Kafka 消息生产消费监控脚本

## 概述

该脚本用于监控 Kafka 主题的消息生产和消费情况，计算生产与消费的差值及比值，帮助识别消息积压问题。

## 功能特性

- 实时监控指定 Kafka 主题的生产偏移量和消费偏移量
- 计算两次检查之间的生产/消费差值
- 计算生产与消费的比值
- 每5分钟输出一次监控结果

## 配置参数

脚本开头包含以下可配置参数：

| 参数名 | 描述 | 默认值 |
|--------|------|--------|
| `KAFKA_PATH` | Kafka 二进制文件路径 | `/usr/local/kafka/bin` |
| `KAFKA_TOPIC` | 要监控的 Kafka 主题 | `your_topic` |
| `KAFKA_GROUP` | 消费者组名称 | `alarm_group` |

## 使用说明

1. 修改脚本开头的配置参数以适应你的环境
2. 给脚本添加可执行权限：
   ```bash
   chmod +x k_consumer.sh
   ```
3. 运行脚本：
   ```bash
   ./k_consumer.sh
   ```

## 输出说明

脚本会每5分钟输出一次监控信息，包括：

- 当前时间
- 消费者组详细信息
- 当前生产偏移量和消费偏移量
- 与上次检查的差值（生产量和消费量）
- 生产与消费的比值

## 注意事项

1. 确保运行脚本的用户有权限访问 Kafka 集群
2. 首次运行时差值和比值为0/N/A，因为还没有历史数据可比较
3. 如果消费差值为0，比值会显示为"N/A"（避免除以零错误）
4. 脚本会持续运行直到手动终止（Ctrl+C）

## 扩展建议

- 可以将输出重定向到日志文件
- 可以添加报警逻辑，当比值超过阈值时触发通知
- 可以集成到监控系统中进行可视化展示